<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>メッセージボード</title>
</head>
<body>
    <header>
        <% if (!loggedIn) { %>
            <a href="/login">ログイン</a>
            <a href="/users/new">新規登録</a>
        <% } else { %>
            <form action="/logout" method="post">
                <input type="hidden" name="_method" value="delete">
                <input type="submit" value="ログアウト">
            </form>
        <% } %> 
    </header>
    <h1>メッセージボード</h1>
    <a href="/messages/new">
        <button>投稿する</button>
    </a>
    <ul>
        <% messages.map((message) => { %>
            <li>
                <p><%= message.content %></p>
                <ul>
                    <% message.replies.map((reply) => { %>
                        <li><%= reply.content %></li>
                    <% }) %>
                </ul>
                <a href="/messages/<%= message.id %>">詳細</a>
                <a href="/messages/<%= message.id %>/edit">編集</a>
                <form action="/messages/like" method="post">
                    <input type="hidden" name="messageId" value="<%= message.id %>">
                    <input type="submit" value="いいね">
                </form>
                <form action="/messages/<%= message.id %>" method="post">
                    <input type="hidden" name="_method" value="delete">
                    <input type="submit" value="削除">
                </form>
                <p>投稿者: <%= message.user.name %></p>
            </li>
        <% }) %>
    </ul>
</body>
</html>